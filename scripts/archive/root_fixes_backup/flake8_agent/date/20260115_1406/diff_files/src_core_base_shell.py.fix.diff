diff --git a/src/core/base/shell.py b/src/core/base/shell.py
index e8d4c85..7d12586 100644
--- a/src/core/base/shell.py
+++ b/src/core/base/shell.py
@@ -28,13 +28,23 @@ import os
 import subprocess
 import logging
 import asyncio
-from typing import List, Any, Optional, Dict
+from typing import Any
 
 __version__ = VERSION
 
+
+
+
+
+
+
+
+
+
+
 class EnvironmentSanitizer:
     """Filters environment variables to prevent secret leakage (Phase 266)."""
-    
+
     ALLOW_LIST = {
         'PATH', 'PYTHONPATH', 'LANG', 'LC_ALL', 'LC_CTYPE',
         'SYSTEMROOT', 'WINDIR', 'USERPROFILE', 'HOME',
@@ -42,38 +52,48 @@ class EnvironmentSanitizer:
         'DV_AGENT_PARENT', 'AGENT_MODELS_CONFIG'
     }
 
+
+
+
+
+
     @classmethod
     def sanitize(cls, env: dict[str, str]) -> dict[str, str]:
         """Returns a copy of the environment containing only allow-listed variables."""
         return {k: v for k, v in env.items() if k.upper() in cls.ALLOW_LIST}
 
+
+
+
+
+
 class ShellExecutor:
     """Safely executes shell commands and records outcomes."""
 
     @staticmethod
-    async def async_run_command(cmd: list[str], workspace_root: str, agent_name: str, 
+    async def async_run_command(cmd: list[str], workspace_root: str, agent_name: str,
                                models_config: Any | None = None, recorder: Any | None = None,
                                timeout: int = 120) -> subprocess.CompletedProcess[str]:
         """Phase 266: Asynchronous subprocess execution with real-time streaming."""
         logging.debug(f"Async-Running command: {' '.join(cmd[:3])}... (timeout={timeout}s)")
-        
+
         env = os.environ.copy()
         if models_config:
             import json
             env['AGENT_MODELS_CONFIG'] = json.dumps(models_config)
-            
+
         env = EnvironmentSanitizer.sanitize(env)
-        
+
         # Phase 132: Apply Sandbox if running in plugin directory
         from src.core.base.sandbox import SandboxManager
         if "plugins" in workspace_root or any("plugins" in c for c in cmd):
             logging.info(f"ShellExecutor: Activating Sandbox Lockdown for {agent_name}")
             env = SandboxManager.get_sandboxed_env(env)
-            
+
         try:
             # Phase 266/132: Start async subprocess with potential flags
             creationflags = SandboxManager.apply_process_limits() if os.name == "nt" else 0
-            
+
             process = await asyncio.create_subprocess_exec(
                 *cmd,
                 stdout=asyncio.subprocess.PIPE,
@@ -83,8 +103,8 @@ class ShellExecutor:
                 creationflags=creationflags
             )
 
-            stdout_data = []
-            stderr_data = []
+            stdout_data: list[Any] = []
+            stderr_data: list[Any] = []
 
             async def stream_reader(pipe: asyncio.StreamReader, container: list[str], label: str) -> None:
                 while True:
@@ -105,7 +125,7 @@ class ShellExecutor:
                     ),
                     timeout=timeout
                 )
-            except asyncio.TimeoutExpired:
+            except asyncio.TimeoutExpired:  # type: ignore[attr-defined]
                 process.kill()
                 logging.error(f"Async shell command TIMEOUT after {timeout}s: {' '.join(cmd)}")
                 raise
@@ -130,17 +150,17 @@ class ShellExecutor:
             return subprocess.CompletedProcess(args=cmd, returncode=1, stdout="", stderr=str(e))
 
     @staticmethod
-    def run_command(cmd: list[str], workspace_root: str, agent_name: str, 
+    def run_command(cmd: list[str], workspace_root: str, agent_name: str,
                     models_config: Any | None = None, recorder: Any | None = None,
                     timeout: int = 120, max_retries: int = 1) -> subprocess.CompletedProcess[str]:
         """Run a command with full environment and telemetry support."""
         logging.debug(f"Running command: {' '.join(cmd[:3])}... (timeout={timeout}s)")
-        
+
         last_error = None
         for attempt in range(max_retries):
             try:
                 env = os.environ.copy()
-                
+
                 # Model and Parent propagation
                 if os.environ.get("DV_AGENT_PARENT"):
                     env['DV_AGENT_PARENT'] = os.environ.get("DV_AGENT_PARENT")
@@ -157,7 +177,7 @@ class ShellExecutor:
                     env=env,
                     check=False
                 )
-                
+
                 if recorder:
                     recorder.record_interaction(
                         provider="Shell",
@@ -166,7 +186,7 @@ class ShellExecutor:
                         result=result.stdout + result.stderr,
                         meta={"exit_code": result.returncode, "attempt": attempt + 1}
                     )
-                
+
                 return result
             except subprocess.TimeoutExpired as e:
                 logging.warning(f"Timeout (attempt {attempt + 1}/{max_retries})")
@@ -174,7 +194,7 @@ class ShellExecutor:
             except Exception as e:
                 logging.error(f"Execution failure: {e}")
                 last_error = e
-                
+
         if isinstance(last_error, subprocess.TimeoutExpired):
              raise last_error
-        return subprocess.CompletedProcess(" ".join(cmd), 1, stdout="", stderr=str(last_error))
\ No newline at end of file
+        return subprocess.CompletedProcess(" ".join(cmd), 1, stdout="", stderr=str(last_error))
