<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyAgent Multimedia Stream Console</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background-color: #020617; color: #f8fafc; font-family: 'Inter', sans-serif; overflow: hidden; }
        .crt-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 2; background-size: 100% 2px, 3px 100%; pointer-events: none;
        }
        .monitor-frame {
            border: 20px solid #1e293b; border-radius: 40px; box-shadow: inset 0 0 100px #000, 0 0 50px rgba(0,0,0,0.5);
            background: #000; height: calc(100vh - 40px); margin: 20px; position: relative;
        }
    </style>
</head>
<body>
    <div class="crt-overlay"></div>
    
    <div class="monitor-frame flex flex-col items-center justify-center">
        <div id="video-stream" class="w-full h-full bg-slate-950 flex items-center justify-center relative overflow-hidden">
            <!-- Simulated 120fps DVD MUXer Output -->
            <div id="status-overlay" class="absolute top-8 left-8 flex flex-col gap-2 z-10">
                <div class="bg-black/50 backdrop-blur px-3 py-1 rounded-full border border-blue-500/30 flex items-center gap-2">
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                    <span class="text-[10px] font-mono uppercase tracking-widest text-blue-400">120FPS MUX ACTIVE</span>
                </div>
                <div id="filter-status" class="text-[10px] font-mono text-slate-500 uppercase tracking-widest">Filters: Bypass</div>
            </div>

            <div class="text-center">
                <i class="fas fa-satellite-dish text-6xl text-slate-800 mb-4"></i>
                <p class="text-slate-600 font-mono text-sm">AWAITING PYAGENT MULTIMODAL SYNC...</p>
            </div>

            <!-- AgentBar Injection Point -->
            <div id="agent-bar-mount"></div>
        </div>

        <!-- Control Panel -->
        <div class="w-full bg-slate-900/50 border-t border-slate-800 p-4 flex justify-between items-center px-12">
            <div class="flex gap-8">
                <div class="flex flex-col">
                    <span class="text-[10px] text-slate-500 uppercase">Input Channel</span>
                    <span class="font-mono text-sm text-blue-400">0x03 (VIDEO_MUX)</span>
                </div>
                <div class="flex flex-col">
                    <span class="text-[10px] text-slate-500 uppercase">Latency</span>
                    <span id="latency-val" class="font-mono text-sm text-green-400">0.42ms</span>
                </div>
            </div>

            <div class="flex gap-4">
                <button onclick="applyFilter('AUDIO', 'noise_reduction')" class="bg-slate-800 hover:bg-slate-700 px-4 py-1 rounded text-xs border border-slate-700 transition-all">
                    <i class="fas fa-sliders-h mr-2 text-green-400"></i> Audio Filters
                </button>
                <button onclick="applyFilter('VIDEO', 'edge_detect')" class="bg-slate-800 hover:bg-slate-700 px-4 py-1 rounded text-xs border border-slate-700 transition-all">
                    <i class="fas fa-camera mr-2 text-blue-400"></i> Vision Filter
                </button>
            </div>

            <div class="text-right">
                <span class="text-[10px] text-slate-600 font-mono">ENCRYPTED AES-GCM-256</span>
            </div>
        </div>
    </div>

    <script>
        async function applyFilter(category, type) {
            const status = document.getElementById('filter-status');
            status.textContent = `Applying ${type}...`;
            status.classList.add('animate-pulse');

            try {
                await fetch('http://localhost:8000/api/stream/filter', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ category, filter_type: type })
                });
                status.textContent = `Filters: ${type} (Active)`;
                status.classList.remove('animate-pulse');
                status.classList.replace('text-slate-500', 'text-green-400');
            } catch (e) {
                status.textContent = `Filters: ERROR`;
            }
        }

        // Mocking the AgentBar dynamic styles
        const agentBarStyles = `
            .agent-bar {
                position: absolute; bottom: 80px; left: 50%; transform: translateX(-50%);
                display: flex; gap: 15px; padding: 10px 20px;
                background: rgba(10, 10, 15, 0.9); border: 1px solid #3b82f6;
                border-radius: 30px; box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
                z-index: 100; backdrop-filter: blur(10px); color: white; min-width: 400px;
            }
            .metric-item { color: #4ade80; font-family: monospace; font-size: 11px; }
            .channel-indicator { display: flex; align-items: center; gap: 8px; font-size: 10px; font-weight: bold; }
            .channel-dot { width: 6px; height: 6px; border-radius: 50%; }
            .dot-active { background: #4ade80; box-shadow: 0 0 5px #4ade80; }
        `;
        const styleSheet = document.createElement("style");
        styleSheet.innerText = agentBarStyles;
        document.head.appendChild(styleSheet);

        // Render Initial AgentBar
        const mount = document.getElementById('agent-bar-mount');
        mount.innerHTML = `
            <div class="agent-bar">
                <div class="flex items-center gap-4 border-r border-slate-700 pr-4">
                    <span class="text-xs font-bold tracking-tighter">VOYAGER MUX</span>
                    <div class="metric-item">FPS: 120.0</div>
                </div>
                <div class="flex gap-4 flex-1 justify-center">
                    <div class="channel-indicator"><div class="channel-dot dot-active"></div> TEXT</div>
                    <div class="channel-indicator"><div class="channel-dot dot-active"></div> AUDIO</div>
                    <div class="channel-indicator"><div class="channel-dot dot-active"></div> VIDEO</div>
                </div>
                <div class="metric-item pl-4 border-l border-slate-700">SYNC: 0.1ms</div>
            </div>
        `;
    </script>
</body>
</html>
