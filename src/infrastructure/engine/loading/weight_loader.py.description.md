# Description: src/infrastructure/engine/loading/weight_loader.py

Module docstring (if present):

    Weight Loading Utilities for PyAgent

    This module provides comprehensive weight loading functionality inspired by
    vLLM's weight_utils.py, with significant enhancements for parallel loading,
    streaming, and cross-format support.

    Key Features:
    - Multi-threaded safetensor loading
    - Atomic file writing for safe checkpointing
    - Streaming weight loading for memory efficiency
    - Format detection and conversion
    - BEYOND vLLM: Predictive prefetching, adaptive batch sizing

    vLLM Patterns:
    - multi_thread_safetensors_weights_iterator
    - atomic_writer context manager
    - safetensors_weights_iterator (eager/lazy)
    - fastsafetensors_weights_iterator
    - runai_safetensors_weights_iterator

Top-level members:
- Classes: WeightFormat, WeightSpec, LoadStats, AtomicWriter, WeightLoader, SafetensorsLoader, MultiThreadWeightLoader, FastSafetensorsLoader, StreamingWeightLoader
- Functions: atomic_writer, detect_weight_format, get_file_lock_path, compute_weight_hash_rust, validate_weight_shapes_rust, filter_shared_tensors

Notes:
- This description was auto-generated by scripts/generate_docs_for_src.py
