--- C:\DEV\PyAgent\src\infrastructure\swarm\fleet\task_planner_agent.py.bak
+++ C:\DEV\PyAgent\src\infrastructure\swarm\fleet\task_planner_agent.py
@@ -1,4 +1,5 @@
 #!/usr/bin/env python3
+# Refactored by copilot-placeholder
 # Copyright 2026 PyAgent Authors
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
@@ -13,7 +14,11 @@
 # limitations under the License.
 
 
-"""Agent specializing in breaking down complex tasks into executable workflows."""
+"""
+TaskPlannerAgent
+
+Agent specializing in breaking down complex tasks into executable workflows.
+"""
 
 from __future__ import annotations
 
@@ -22,8 +27,10 @@
 from typing import Any
 
 from src.core.base.common.base_utilities import as_tool, create_main_function
-from src.core.base.lifecycle.base_agent import BaseAgent
+from src.core.base.base_agent import BaseAgent
 from src.core.base.lifecycle.version import VERSION
+from src.core.base.agent_state_manager import StateTransaction
+from src.core.base.models.communication_models import CascadeContext
 
 __version__ = VERSION
 
@@ -40,7 +47,7 @@
             "Output your plan as a JSON-compatible list of steps."
         )
 
-    @as_tool
+    @as_tool(priority=1)
     def generate_shared_dependencies(self, prompt: str) -> str:
         """Generates a contract file (SHARED_DEPS.md) for cross-agent coordination."""
         logging.info("Generating SHARED_DEPS.md contract...")
@@ -59,6 +66,19 @@
 
     def _get_default_content(self) -> str:
         return "# Workspace Planning Log\n\n## Active Plans\nNone.\n"
+
+    async def _process_task(self, task_data: dict[str, Any]) -> Any:
+        """Process a single task from the queue."""
+        action = task_data.get("action")
+        args = task_data.get("args", [])
+
+        if action == "generate_shared_dependencies":
+            return self.generate_shared_dependencies(*args)
+        elif action == "create_plan":
+            return self.create_plan(*args)
+        else:
+            logging.warning(f"Unknown task action: {action}")
+            return None
 
     def create_plan(self, user_request: str) -> list[dict[str, Any]]:
         """Generates a structured plan for the FleetManager following the scientific method."""
